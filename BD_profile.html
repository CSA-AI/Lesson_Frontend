---
layout: base
permalink: /profile/
title: Profile
search_exclude: false
---
<script>

    function getCookie(name) {
        const value = `; ${document.cookie}`;
        const parts = value.split(`; ${name}=`);
        if (parts.length === 2) return parts.pop().split(';').shift();
    }

    function parseJwt (token) {
        var base64Url = token.split('.')[1];
        var base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
        var jsonPayload = decodeURIComponent(window.atob(base64).split('').map(function(c) {
            return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
        }).join(''));

        return JSON.parse(jsonPayload);
    }
    function update() {
        //pull from backend and update values
        // placeholders
        email=parseJwt(getCookie("token")).sub;
        function getRandomInt(max) {
            return Math.floor(Math.random() * max);
        }
        steps = (getRandomInt(100));
        calories = (getRandomInt(1000));
        //placeholders
        document.getElementById("welcome").innerHTML = "Welcome " + email + "!";
        document.getElementById("steps").innerHTML = steps;
        document.getElementById("calories").innerHTML = calories;
    }
    function edit() {
        steps = prompt("enter steps count: ")
        calories = prompt("enter calories burnt: ")

        document.getElementById("steps").innerHTML = steps;
        document.getElementById("calories").innerHTML = calories;
    }
    function post() {
        date = new Date();
        day = date.getDate();
        month = date.getMonth() + 1;
        year = date.getFullYear();
        currentDate = `0${month}-${day}-${year}`;
        console.log(currentDate);
        steps = document.getElementById("steps").innerHTML;
        calories = document.getElementById("calories").innerHTML;
        
        fetch("https://jsonplaceholder.typicode.com/todos", {
            method: "POST",
            body: JSON.stringify({
                userId: 1,
                title: "Fix my bugs",
                completed: false
            }),
            headers: {
                "Content-type": "application/json; charset=UTF-8"
            }
        });
        alert("database updated!")
    }
    function delUser() {
        //backend self.delete()
    }
</script>

<body onload="update()">
<div style="height: 500px; width: 500px; background-color: blueviolet;">
    <div style="Font-size: 32px; text-align: center; height: auto; width: 500px; padding: 10px; position: relative;">
        Profile
    </div>
    <div style="text-align: center; height: auto; width: 500px; padding: 10px; position: relative;">
        <div style="font-size: 18px;" id="welcome">Welcome!</div>
        <div style="font-size: 18px;">Number of steps: </div><div id="steps"></div>
        <div style="font-size: 18px;">Calories burnt: </div><div id="calories"></div>
        <button onClick="update()">Update</button>
        <div></div>
        <button onClick="edit()">Edit</button>
        <button onClick="post()">Post</button>
        <div></div>
        <button onClick="delUser()">Delete user</button>
    </div>
</div>
</body>